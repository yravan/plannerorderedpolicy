<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Combining Planning and Diffusion for Mobility with Unknown Dynamics">
  <meta name="keywords" content="Diffusion models, Mobile manipulation, Learning from demonstrations">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Planner-Ordered Policy </title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body onload="updateResultVideo();">

<section class="hero" style="background-color: #ffffff; z-index:-10">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Combining Planning and Diffusion <br>for Mobility with Unknown Dynamics</h1>
          <h3 class="title is-4 conference-authors"><a target="_blank" href="https://2025.ieee-icra.org/">ICRA 2025</a></h3>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
                <a target="_blank" href="https://yravan.github.io/">Yajvan Ravan</a><sup>1</sup>,</span>
            <span class="author-block">
              <a target="_blank" href="https://zt-yang.com/">Zhutian Yang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a target="_blank" href="https://taochenshh.github.io/">Tao Chen</a><sup>1</sup>,</span><br>
            <span class="author-block">
              <a target="_blank" href="http://people.csail.mit.edu/tlp/">Tomás Lozano-Pérez</a><sup>1</sup>,</span>
            <span class="author-block">
              <a target="_blank" href="http://people.csail.mit.edu/lpk/">Leslie Kaelbling</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>MIT</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a target="_blank" href="http://arxiv.org/abs/2309.00966"
                   class="external-link button is-normal is-rounded is-dark">
                   <!-- "https://arxiv.org/abs/2211.01576" -->
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>UPDATE!!!</span>
                </a>
              </span>

            <!-- Video Link. -->
            <!-- <span class="link-block">
              <a target="_blank" href="https://www.youtube.com/watch?v=kDliSCMW2XY"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-youtube"></i>
                </span>
                <span>Video</span>
              </a>
            </span> -->

            <!-- Code Link.  -->
            <span class="link-block">
              <a target="_blank" href="https://github.com/zt-yang/diffusion-ccsp"
                 class="external-link button is-normal is-rounded is-dark">
                <span class="icon">
                    <i class="fab fa-github"></i>
                </span>
                <span>UPDATE!!!</span>
                </a>
            </span>

            </div>
          </div>


        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-fullhd" style="margin-bottom: -300px; z-index:-200">
    <div class="hero-body">
      <div class="container">
        <div class="columns is-vcentered  is-centered">
          <video id="teaser" autoplay muted loop height="300px">
            <source src="media/kitchens.mp4"
                    type="video/mp4">
          </video>
          </br>
        </div>
      </div>
    </div>
  </div>
</section> -->

<section class="hero" style="background-color: #ffffff; z-index:-10; margin-top: -3rem">
  <div class="container">
    <div class="hero-body">

      <div class="video-teaser">
        <video poster="" autoplay muted width="50%" controls>
          <source src="media/ICRA_teaser_high_res.mp4" type="video/mp4">
        </video>
      </div>

       <div class="container" style="padding-top:1.5rem; padding-bottom:0.5rem">
         <h2 class="subtitle has-text-centered">
         <span class="popi">Planner-Ordered Policy (PoPi)</span> is an approach for long-
         horizon robot manipulation problems in which the dynamics are
         partially unknown, for example, pushing and pulling a 5-wheeled office chair.</b>
         </h2>
       </div>

      <!-- <img src="media/figures/teaser.png" class="full-image" style="width:80%;padding-bottom: 2rem"
         alt="Diffusion-CCSP combines diffusion models, representing individual constraints, to generate object placement poses that are reachable and allow collision-free grasps. The choice of an object placement depends on both semantic constraints about object placement and collision avoidance constraints on the object and the robot gripper." /> -->

       <!-- <div class="container" style="padding-bottom:2rem">
         <h2 class="subtitle has-text-centered">
         Below are example training data, placement poses generated by <span class="popi">Diffusion-CCSP</span>, and execution trajectories produced by motion planner.</b>
         </h2>
       </div> -->

      <table class='video-table'>
        <tr>
          <th>RRT vs <span class="popi">PoPi</span> vs Long-Horizon Diffusion</th>
        </tr>
        <tr>
          <td>
            <!-- <b>Execution Trajectories Planning by RRT</b> -->
            <video poster="" autoplay muted loop height="100%" playbackRate=2>
              <source src="media/ours_vs_baselines.mp4" type="video/mp4">
            </video>
          </td>
        </tr>
      </table>

    </div>
  </div>
</section>


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">

      <h3 class="title is-3 has-text-centered" style="padding-bottom: 20pt;">Motivations</h3>

      <h2 class="subtitle">
        Many robot tasks involve finding and following a <b>long-horizon path</b>
        while interacting with an environment whose <b>dynamics are
        not known</b>.<br> For example, a robot arm pushing an object
        among obstacles on a table or a mobile robot pushing an
        office chair among furniture are both facing this type of
        problem
      </h2>

      <img src="media/figures/website_motivation.png" class="full-image" style="width:60%;padding-bottom: 2.5rem" alt="" />

      <h2 class="subtitle">
        We seek an approach that <br>
        &nbsp;&nbsp;&nbsp;&nbsp;(1) allows the robot to be trained quickly in the real world, without access to a simulator, as the dynamics present a large sim-to-real gap, <br>
        &nbsp;&nbsp;&nbsp;&nbsp;(2) generalizes to somewhat different environment.<br><br>
        <span class="popi">Planner-Ordered Policy</span> learns a short-horizon, diffusion-based
        manipulation policy  policy via imitation learning and uses a “global” motion planner
        to define waypoints for the local policy.
    </h2>
    

      <img src="media/figures/website_venn_diagram.png" class="full-image" style="width:60%;padding-bottom: 0.5rem" alt="" />

    </div>
  </div>
</section>


<section class="hero is-small">
  <div class="container is-max-widescreen" style="padding: 2rem">

    <div class="rows is-centered ">
      <div class="row is-full-width">
      
      <h3 class="title is-3 has-text-centered">Abstract</h3>

      <!-- <p class="justify">
            <img src="media/figures/images.jpg" class="interpolation-image" width="480" align="right"
                 style="margin:0% 1% "
                 alt="Image views" />
                 This paper introduces an approach for learning to solve continuous constraint satisfaction problems (CCSP) in robotic reasoning and planning. Previous methods primarily rely on hand-engineering or learning generators for specific constraint types and then rejecting the value assignments when other constraints are violated. By contrast, our model, the compositional diffusion continuous constraint solver (Diffusion-CCSP) derives global solutions to CCSPs by representing them as factor graphs and combining the energies of diffusion models trained to sample for individual constraint types. Diffusion-CCSP exhibits strong generalization to novel combinations of known constraints, and it can be integrated into a task and motion planner to devise long-horizon plans that include actions with both discrete and continuous parameters.
          </p>
        <br><br> -->
        <p class="justify" style="padding-left: 8rem; padding-right: 8rem; padding-bottom: 2rem; ">
            Manipulation of large objects over long horizons
            (such as carts in a warehouse) is an essential skill for deployable
            robotic systems. Large objects require mobile manipulation
            which involves simultaneous manipulation, navigation, and
            movement with the object in tow. In many real-world situations,
            object dynamics are incredibly complex, such as the interaction
            of an office chair (with a rotating base and five caster wheels)
            and the ground. We present a hierarchical algorithm for long-
            horizon robot manipulation problems in which the dynamics are
            partially unknown. We observe that diffusion-based behavior
            cloning is highly effective for short-horizon problems with
            unknown dynamics, so we decompose the problem into an
            abstract high-level, obstacle-aware motion-planning problem
            that produces a waypoint sequence. We use a short-horizon,
            relative-motion diffusion policy to achieve the waypoints in
            sequence. We train mobile manipulation policies on a Spot robot
            that has to push and pull an office chair. Our hierarchical ma-
            nipulation policy performs consistently better, especially when
            the horizon increases, compared to a diffusion policy trained
            on long-horizon demonstrations or motion planning assuming
            a rigidly-attached object (success rate of 8 (versus 0 and 5
            respectively) out of 10 runs). Importantly, our learned policy
            generalizes to new layouts, grasps, chairs, and flooring that
            induces more friction, without any further training, showing
            promise for other complex mobile manipulation problems
        </p>

      <h3 class="title is-3 has-text-centered" style="padding-bottom: 20pt;"><span class="popi">Planner-Ordered Policy</span></h3>
      <img src="media/figures/popi.png" class="full-image" style="width:60%;padding-bottom: 2.5rem" alt="" />
      <h3 class="title is-3 has-text-centered" style="padding-bottom: 20pt;">Experiments</h3>

        <img src="media/figures/domains.png" class="full-image" style="width:80%" alt="" />

        <div style="padding-left: 4rem; ">
          <p>
            <b>Tasks</b>:
            <ul>
              <li>(a) Testing the long-horizon success to move the chair on a 10m trajectory, with 3 turns, around an obstacle</li>
              <li>(b) Testing the generalization on an environment with more complex dynamics (friction from carpeted floor) and different obstacle configuration</li>
              <li>(c) Testing the generalization with an unseen chair & unseen grasp. Both present novel dynamics not seen in training demonstrations.</li>
          </p>
        </div>

        <div style="padding-left: 4rem; ">
          <p>
            <b>Baselines</b>:
            <ul>
              <li>(1) RRT</li>
              <li>(2) A*</li>
              <li>(3) Global Diffusion</li>
          </p>
        </div>

      </div>
    </div>
  </div>
</section>

<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered has-text-centered">
        <div class="column is-two-thirds">
          <h3 class="title is-3 has-text-centered">Video</h3>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/kDliSCMW2XY?rel=0&amp;showinfo=0"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">

      <h3 class="title is-3 has-text-centered" style="padding-bottom: 20pt;">Results</h3>

      <h3 class="subtitle has-text-centered">
        We find that <span class="popi">PoPi</span> performs consistently better as the horizon
            increases, compared to a ”global” diffusion policy or motion
            planning assuming a rigidly-attached object. Importantly,
            PoPi generalizes to new layouts, grasps, chairs, and even
            flooring, without any further training
      </h3>

      <h3 class="subtitle has-text-centered">
        <b> RRT vs <span class="popi">PoPi</span> vs Long-Horizon Diffusion</b>
      </h3>
      
      <iframe src="media/ours_vs_baselines.mp4"
      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      
    </div>
  </div>
</section>


<section class="hero is-light is-small">
    <div class="hero-body">
      <div class="container">
        <div class="columns is-centered has-text-centered">
          <div class="column is-two-thirds">
            <h3 class="title is-3 has-text-centered">Video</h3>
            <div class="publication-video">
              <!-- https://www.youtube.com/watch?v=VLikGooIdwg&ab_channel=ZhutianYang-->
              <iframe src="media/ICRA_video_high_res.mp4"
                      frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-widescreen content">
    <h2 class="title">BibTeX</h2>
    <pre><code>UPDATE!!!
  </code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column">
        <div class="content has-text-centered">
          <p>
            Website template borrowed from <a href="https://github.com/nerfies/nerfies.github.io">NeRFies</a> made by the amazing <a href="https://keunhong.com/">Keunhong Park</a> and <a href="https://mohitshridhar.com/">Mohit Shridhar</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
